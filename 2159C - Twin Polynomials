#include <iostream>
#include <cstdio>
#include <vector>
#include <cmath>
using namespace std;
using ll = long long;

const int MXN = 4e5 + 1;
const ll MOD = 1e9 + 7;

vector<ll> fn(MXN, 1);

ll solve()
{
	int n;
	cin >> n;
	vector<int> a(n + 1);
	for (int i = 0; i <= n; i++) cin >> a[i];

	for (int i = 0; i <= n; i++) if (a[i] > 0)
	{
		if (a[i] > n) return 0;
		if (a[a[i]] != i)
		{
			if (a[a[i]] != -1) return 0;
			a[a[i]] = i;
		}
	}

	int deg = 0;
	for (int i = 1; i <= n; i++) if (a[i] == -1) deg++;

	if (a[n] != -1) return fn[deg];
	if (deg == 0) return 1;
	return (fn[deg] - fn[deg - 1] + MOD) % MOD;
}

int main()
{
	fn[1] = 2;
	for (int i = 2; i < MXN; i++) fn[i] = (fn[i - 1] * 2 + fn[i - 2] * (i - 1)) % MOD;
	
	int _;
	cin >> _;
	while (_--) cout << solve() << "\n";
}
