#include <iostream>
#include <cstdio>
#include <vector>
#include <cmath>
using namespace std;
 
int main()
{
	ios::sync_with_stdio(false);
	cin.tie(nullptr);
 
	int _;
	cin >> _;
	while (_--)
	{
		int n, __;
		cin >> n >> __;
		vector<int> a(n);
		for (int i = 0; i < n; i++) cin >> a[i];
 
		vector<int> pref(n + 1, 0), prefb(n + 1, 0);
		for (int i = 0; i < n; i++)
		{
			pref[i + 1] = pref[i], prefb[i + 1] = prefb[i];
			int curr = -1, num = 1;
			while(num <= a[i]) num *= 2, curr++;
			pref[i + 1] += curr;
			if (a[i] - num / 2 == 1) prefb[i + 1]++;
			else if (a[i] - num / 2 > 1) pref[i + 1]++;
		}
 
		while (__--)
		{
			int l, r;
			cin >> l >> r;
			l--;
 
			cout << pref[r] - pref[l] + (prefb[r] - prefb[l]) / 2 << "\n";
		}
	}
}
